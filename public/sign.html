<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>TON Connect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        background-color: #000;
        color: #fff;
        font-family: 'Segoe UI', sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        flex-direction: column;
        text-align: center;
        margin: 0;
      }
      #ton-connect-ui-container {
        margin-top: 20px;
        max-width: 320px;
        background: #111;
        padding: 20px;
        border-radius: 16px;
        box-shadow: 0 0 10px rgba(0,255,255,0.3);
      }
      #status {
        margin-top: 20px;
        font-size: 1rem;
        color: #00bfff;
      }
    </style>
    <script type="module">
      import { TonConnectUI } from "https://unpkg.com/@tonconnect/ui@latest";

      const urlParams = new URLSearchParams(window.location.search);
      const to = urlParams.get("to");
      const amount = urlParams.get("amount");
      const nano = amount ? amount.toString() : "";

      const tonConnectUI = new TonConnectUI({
        manifestUrl: "https://gigi-ton-connect-v2-deploy.onrender.com/tonconnect-manifest.json",
        buttonRootId: "ton-connect-ui-container",
      });

      async function sendTx() {
        const connectedWallet = await tonConnectUI.connected;
        if (!connectedWallet) {
          document.getElementById("status").textContent = "‚ö†Ô∏è Connect a wallet to continue.";
          return;
        }

        try {
          const result = await tonConnectUI.sendTransaction({
            validUntil: Math.floor(Date.now() / 1000) + 600,
            messages: [{ address: to, amount: nano }],
          });

          document.getElementById("status").textContent =
            "‚úÖ Transaction sent! BOC: " + result?.boc;
        } catch (err) {
          console.error(err);
          document.getElementById("status").textContent =
            "‚ùå Signing failed or cancelled.";
        }
      }

      // Wait a bit before prompting for signature
      setTimeout(sendTx, 4000);
    </script>
  </head>
  <body>
    <h2>üîê Sign TON Transaction</h2>
    <div id="ton-connect-ui-container"></div>
    <div id="status">Connecting wallet...</div>
  </body>
</html>
